{"ast":null,"code":"import axios from \"axios\";\nimport { decodeToken, getUserIdFromToken, getUsernameFromToken, getRoleFromToken } from './tokenService';\nimport jwtDecode from \"jwt-decode\"; // You can use a library like jwt-decode to decode the JWT\n\nconst login = async (email, password) => {\n  try {\n    const response = await axios.post(`${process.env.REACT_APP_API_BASE_URL}/auth/login`, {\n      email,\n      password\n    });\n    if (response.data.error) {\n      throw new Error(response.data.error);\n    }\n    console.log(\"Response from server:\", response);\n    const token = response.data.jwtToken;\n    console.log(\"Received token:\", token);\n    const decodedToken = jwtDecode(token);\n    console.log(\"Decoded token:\", decodedToken);\n\n    // Extract user information from decoded token\n    const user = {\n      username: getUsernameFromToken(),\n      role: getRoleFromToken(),\n      userId: getUserIdFromToken()\n    };\n    console.log(user);\n\n    // Store token in local storage\n    localStorage.setItem(\"token\", token);\n    return user;\n  } catch (error) {\n    console.error(\"Login error\", error);\n    throw error;\n  }\n};\nconst register = async (username, email, password, role) => {\n  const payload = {\n    UserName: username,\n    Email: email,\n    Password: password,\n    Role: role\n  };\n  console.log(\"Sending payload to server:\", payload);\n  try {\n    const response = await axios.post(`${process.env.REACT_APP_API_BASE_URL}/users`, payload);\n    if (response.data.error) {\n      throw new Error(response.data.error);\n    }\n    const token = response.data.jwtToken;\n    const decodedToken = jwtDecode(token);\n    const user = {\n      username: getUsernameFromToken(),\n      role: getRoleFromToken(),\n      userId: getUserIdFromToken()\n    };\n    console.log(\"Server responded with:\", response.data);\n    localStorage.setItem(\"token\", token);\n    return user;\n  } catch (error) {\n    if (error.response) {\n      console.error(\"Server responded with:\", error.response.data.message);\n      console.error(\"Errors:\", error.response.data.errors);\n    }\n    console.error(\"Registration error\", error.message);\n    throw error;\n  }\n};\nconst logout = () => {\n  localStorage.removeItem(\"token\");\n};\nexport const AuthService = {\n  login,\n  logout,\n  register\n};","map":{"version":3,"names":["axios","decodeToken","getUserIdFromToken","getUsernameFromToken","getRoleFromToken","jwtDecode","login","email","password","response","post","process","env","REACT_APP_API_BASE_URL","data","error","Error","console","log","token","jwtToken","decodedToken","user","username","role","userId","localStorage","setItem","register","payload","UserName","Email","Password","Role","message","errors","logout","removeItem","AuthService"],"sources":["C:/Users/sandi/TaskManagment-Front end/task-managment/src/services/AuthService.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { decodeToken, getUserIdFromToken, getUsernameFromToken, getRoleFromToken } from './tokenService';\r\nimport jwtDecode from \"jwt-decode\"; // You can use a library like jwt-decode to decode the JWT\r\n\r\nconst login = async (email, password) => {\r\n\r\n    try {\r\n        const response = await axios.post(`${process.env.REACT_APP_API_BASE_URL}/auth/login`, {\r\n            email,\r\n            password,\r\n        });\r\n\r\n        if (response.data.error) {\r\n            throw new Error(response.data.error);\r\n        }\r\n        console.log(\"Response from server:\", response);\r\n        const token = response.data.jwtToken;\r\n        console.log(\"Received token:\", token);\r\n        const decodedToken = jwtDecode(token);\r\n        console.log(\"Decoded token:\", decodedToken);\r\n\r\n        // Extract user information from decoded token\r\n        const user = {\r\n            username: getUsernameFromToken(),\r\n            role: getRoleFromToken(),\r\n            userId: getUserIdFromToken()\r\n        };\r\n\r\n        console.log(user);\r\n\r\n        // Store token in local storage\r\n        localStorage.setItem(\"token\", token);\r\n\r\n        return user;\r\n\r\n    } catch (error) {\r\n        console.error(\"Login error\", error);\r\n        throw error;\r\n    }\r\n};\r\n\r\nconst register = async (username, email, password, role) => {\r\n\r\n    const payload = {\r\n        UserName: username,\r\n        Email: email,\r\n        Password: password,\r\n        Role: role\r\n    };\r\n\r\n    console.log(\"Sending payload to server:\", payload);\r\n\r\n    try {\r\n        const response = await axios.post(`${process.env.REACT_APP_API_BASE_URL}/users`, payload);\r\n\r\n        if (response.data.error) {\r\n            throw new Error(response.data.error);\r\n        }\r\n\r\n        const token = response.data.jwtToken;\r\n        const decodedToken = jwtDecode(token);\r\n\r\n        const user = {\r\n            username: getUsernameFromToken(),\r\n            role: getRoleFromToken(),\r\n            userId: getUserIdFromToken()\r\n        };\r\n\r\n        console.log(\"Server responded with:\", response.data);\r\n\r\n        localStorage.setItem(\"token\", token);\r\n\r\n        return user;\r\n\r\n    } catch (error) {\r\n        if (error.response) {\r\n            console.error(\"Server responded with:\", error.response.data.message);\r\n            console.error(\"Errors:\", error.response.data.errors);\r\n        }\r\n        console.error(\"Registration error\", error.message);\r\n        throw error;\r\n    }\r\n};\r\n\r\nconst logout = () => {\r\n    localStorage.removeItem(\"token\");\r\n};\r\n\r\n\r\nexport const AuthService = {\r\n    login,\r\n    logout,\r\n    register\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}